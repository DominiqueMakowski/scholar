---
title: "scholar: Analyse citation data from Google Scholar"
author: "Guangchuang Yu, James Keirstead and Gregory Jefferis"
date: "`r Sys.Date()`"
output:
  prettydoc::html_pretty:
    toc: true
    theme: cayman
    highlight: github
  pdf_document:
    toc: true
vignette: >
  %\VignetteIndexEntry{scholar introduction}
  %\VignetteEngine{knitr::rmarkdown}
  %\usepackage[utf8]{inputenc}
  %\VignetteDepends{ggplot2}
---

```{r style, echo=FALSE, results="asis", message=FALSE}
knitr::opts_chunk$set(
  tidy = FALSE,
  message = FALSE)
```


```{r echo=FALSE, results="hide", message=FALSE}
library("scholar")
library("ggplot2")
theme_set(theme_minimal())
```


# Retrieving basic information

```{r}
## Define the id for Richard Feynman
id <- 'MlMKkPUAAAAJ'

## Get his profile
profile <- get_profile(id)

## Print his name, affliation and homepage
profile$name
profile$affiliation
profile$homepage

## Print his citation index
profile$h_index
profile$i10_index
```



# Retrieving publications


`get_publications()` return a `data.frame` of publication records. It contains
information of the publications, including *title*, *author list*, *page
number*, *citation number*, *publication year*, *etc.*.

The `pubid` is the article ID used by Google Scholar and the identifier
that is used to retrieve the citation history of a selected publication.

```{r}
## Get his publications (a large data frame)
publications <- get_publications(id)
head(publications, 5)
```
```{r, echo=FALSE}
knitr::kable(head(publications, 5))
```



# Retrieving citation data

```{r}
## Get his citation history, i.e. citations to his work in a given year
citations <- get_citation_history(id)

## Plot citation trend
library(ggplot2)

ggplot(citations, aes(year, cites)) + 
  geom_line() + 
  geom_point()
```
```{r, eval=FALSE, include=FALSE}
# To put it on the README
ggsave("img/fig1.png",
       ggplot(citations, aes(year, cites)) + geom_line() + geom_point(), width=10, height=6)
```


Users can retrieve the citation history of a particular publication with
`get_article_cite_history()`.


```{r}
## The following publication will be used to demonstrate article citation history
as.character(publications$title[1])

## Get article citation history
article_citations <- get_article_cite_history(id, publications$pubid[1])

## Plot citation trend
ggplot(article_citations, aes(year, cites)) +
  geom_segment(aes(xend = year, yend = 0), size=1, color='darkgrey') +
  geom_point(size=3, color='firebrick') +
  ggtitle("Article Citation History", as.character(publications$title[1]))
```
```{r, eval=FALSE, include=FALSE}
# To put it on the README
ggsave("img/fig2.png",
       ggplot(article_citations, aes(year, cites)) +
  geom_segment(aes(xend = year, yend = 0), size=1, color='darkgrey') +
  geom_point(size=3, color='firebrick') +
  ggtitle("Article Citation History", as.character(publications$title[1])), width=10, height=6)
```




# Comparing scholars
You can compare the citation history of scholars by fetching data with 
`compare_scholars`.
```{r}
# Compare Feynman and Stephen Hawking
ids <- c('B7vSqZsAAAAJ', 'qj74uXkAAAAJ')

# Get a data frame comparing the number of citations to their work in
# a given year
comparison <- compare_scholars(ids)

## remove some 'bad' records without sufficient information
comparison <- subset(comparison, !is.na(year) & year > 1900)
ggplot(comparison, aes(year, cites, group=name, color=name)) + geom_line() + theme(legend.position="bottom")

## Compare their career trajectories, based on year of first citation
careers <- compare_scholar_careers(ids)
ggplot(careers, aes(career_year, cites, group=name, color=name)) + geom_line() + geom_point() +
    theme(legend.position=c(.2, .8))
```
```{r, eval=FALSE, include=FALSE}
# To put it on the README
ggsave("img/fig3.png",
       ggplot(careers, aes(career_year, cites, group=name, color=name)) + geom_line() + geom_point() +
    theme(legend.position=c(.2, .8)), width=10, height=6)
```



# Visualizing and comparing network of coauthors

```{r}
# Be careful with specifying too many coauthors as the visualization of the
# network can get very messy.
coauthor_network <- get_coauthors('amYIKXQAAAAJ&hl', n_coauthors = 7)

coauthor_network
```


And then we have a built-in function to plot this visualization.

```{r}
plot_coauthors(coauthor_network)
```

Note however, that these are the coauthors listed in Google Scholar profile and not coauthors from all publications.
